{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/mcs/Development/projects/sandbox/tweet-review/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useEffect, useState } from \"react\";\nimport Link from \"next/link\";\nimport Head from \"next/head\";\nimport Cookies from \"js-cookie\";\nimport parseJwt from \"../lib/parseJwt\";\nexport default (function () {\n  var _useState = useState(false),\n      isAuth = _useState[0],\n      setAuth = _useState[1];\n\n  var _useState2 = useState(null),\n      profile = _useState2[0],\n      setProfile = _useState2[1];\n\n  useEffect(function () {\n    function getAuth() {\n      if (Cookies.get(\"id_token\")) {\n        setAuth(true);\n        setProfile(parseJwt(Cookies.get(\"id_token\")));\n        return null;\n      }\n    }\n\n    getAuth();\n  }, []);\n\n  var getSecret =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var res, secret, newProfile;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"/api/data/secret\");\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.text();\n\n            case 5:\n              secret = _context.sent;\n              newProfile = _objectSpread({}, profile, {\n                secret: secret\n              });\n              setProfile(newProfile);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getSecret() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var logout =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"/api/auth/logout\");\n\n            case 2:\n              res = _context2.sent;\n\n              if (res.status === 200) {\n                Cookies.remove(\"id_token\");\n                setAuth(false);\n                setProfile(null);\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function logout() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(Head, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }, __jsx(\"title\", {\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }, \"Tweet Review\"), __jsx(\"link\", {\n    rel: \"stylesheet\",\n    href: \"https://css.zeit.sh/v1.css\",\n    type: \"text/css\",\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38\n    },\n    __self: this\n  })), __jsx(\"main\", {\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, \"Tweet Review\"), __jsx(\"div\", {\n    className: \"jsx-3760695332\" + \" \" + \"buttons\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }, __jsx(\"button\", {\n    onClick: getSecret,\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, \"Tell Me a Secret!\"), !isAuth ? __jsx(Link, {\n    href: \"/api/auth/login\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, __jsx(\"button\", {\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, \"Login\"))) : __jsx(\"button\", {\n    onClick: logout,\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, \"Logout\")), profile && profile.secret && __jsx(\"p\", {\n    className: \"jsx-3760695332\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, profile.secret)), __jsx(_JSXStyle, {\n    id: \"3760695332\",\n    __self: this\n  }, \".buttons.jsx-3760695332{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY3MvRGV2ZWxvcG1lbnQvcHJvamVjdHMvc2FuZGJveC90d2VldC1yZXZpZXcvcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMkRrQixBQUd3QiwwRUFDaUIsbUhBQ2hDIiwiZmlsZSI6Ii9Vc2Vycy9tY3MvRGV2ZWxvcG1lbnQvcHJvamVjdHMvc2FuZGJveC90d2VldC1yZXZpZXcvcGFnZXMvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgTGluayBmcm9tIFwibmV4dC9saW5rXCI7XG5pbXBvcnQgSGVhZCBmcm9tIFwibmV4dC9oZWFkXCI7XG5pbXBvcnQgQ29va2llcyBmcm9tIFwianMtY29va2llXCI7XG5pbXBvcnQgcGFyc2VKd3QgZnJvbSBcIi4uL2xpYi9wYXJzZUp3dFwiO1xuXG5leHBvcnQgZGVmYXVsdCAoKSA9PiB7XG4gIGNvbnN0IFtpc0F1dGgsIHNldEF1dGhdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcHJvZmlsZSwgc2V0UHJvZmlsZV0gPSB1c2VTdGF0ZShudWxsKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBmdW5jdGlvbiBnZXRBdXRoKCkge1xuICAgICAgaWYgKENvb2tpZXMuZ2V0KFwiaWRfdG9rZW5cIikpIHtcbiAgICAgICAgc2V0QXV0aCh0cnVlKTtcbiAgICAgICAgc2V0UHJvZmlsZShwYXJzZUp3dChDb29raWVzLmdldChcImlkX3Rva2VuXCIpKSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICBnZXRBdXRoKCk7XG4gIH0sIFtdKTtcbiAgY29uc3QgZ2V0U2VjcmV0ID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKFwiL2FwaS9kYXRhL3NlY3JldFwiKTtcbiAgICBjb25zdCBzZWNyZXQgPSBhd2FpdCByZXMudGV4dCgpO1xuICAgIGNvbnN0IG5ld1Byb2ZpbGUgPSB7IC4uLnByb2ZpbGUsIHNlY3JldCB9O1xuICAgIHNldFByb2ZpbGUobmV3UHJvZmlsZSk7XG4gIH07XG4gIGNvbnN0IGxvZ291dCA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChcIi9hcGkvYXV0aC9sb2dvdXRcIik7XG4gICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgQ29va2llcy5yZW1vdmUoXCJpZF90b2tlblwiKTtcbiAgICAgIHNldEF1dGgoZmFsc2UpO1xuICAgICAgc2V0UHJvZmlsZShudWxsKTtcbiAgICB9XG4gIH07XG4gIHJldHVybiAoXG4gICAgPD5cbiAgICAgIDxIZWFkPlxuICAgICAgICA8dGl0bGU+VHdlZXQgUmV2aWV3PC90aXRsZT5cbiAgICAgICAgPGxpbmtcbiAgICAgICAgICByZWw9XCJzdHlsZXNoZWV0XCJcbiAgICAgICAgICBocmVmPVwiaHR0cHM6Ly9jc3MuemVpdC5zaC92MS5jc3NcIlxuICAgICAgICAgIHR5cGU9XCJ0ZXh0L2Nzc1wiXG4gICAgICAgIC8+XG4gICAgICA8L0hlYWQ+XG4gICAgICA8bWFpbj5cbiAgICAgICAgPGgxPlR3ZWV0IFJldmlldzwvaDE+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uc1wiPlxuICAgICAgICAgIDxidXR0b24gb25DbGljaz17Z2V0U2VjcmV0fT5UZWxsIE1lIGEgU2VjcmV0ITwvYnV0dG9uPlxuICAgICAgICAgIHshaXNBdXRoID8gKFxuICAgICAgICAgICAgPExpbmsgaHJlZj17XCIvYXBpL2F1dGgvbG9naW5cIn0+XG4gICAgICAgICAgICAgIDxhPlxuICAgICAgICAgICAgICAgIDxidXR0b24+TG9naW48L2J1dHRvbj5cbiAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2xvZ291dH0+TG9nb3V0PC9idXR0b24+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIHtwcm9maWxlICYmIHByb2ZpbGUuc2VjcmV0ICYmIDxwPntwcm9maWxlLnNlY3JldH08L3A+fVxuICAgICAgPC9tYWluPlxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAuYnV0dG9ucyB7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8Lz5cbiAgKTtcbn07XG4iXX0= */\\n/*@ sourceURL=/Users/mcs/Development/projects/sandbox/tweet-review/pages/index.js */\"));\n});","map":{"version":3,"sources":["/Users/mcs/Development/projects/sandbox/tweet-review/pages/index.js"],"names":["useEffect","useState","Link","Head","Cookies","parseJwt","isAuth","setAuth","profile","setProfile","getAuth","get","getSecret","fetch","res","text","secret","newProfile","logout","status","remove"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport Link from \"next/link\";\nimport Head from \"next/head\";\nimport Cookies from \"js-cookie\";\nimport parseJwt from \"../lib/parseJwt\";\n\nexport default () => {\n  const [isAuth, setAuth] = useState(false);\n  const [profile, setProfile] = useState(null);\n  useEffect(() => {\n    function getAuth() {\n      if (Cookies.get(\"id_token\")) {\n        setAuth(true);\n        setProfile(parseJwt(Cookies.get(\"id_token\")));\n        return null;\n      }\n    }\n    getAuth();\n  }, []);\n  const getSecret = async () => {\n    const res = await fetch(\"/api/data/secret\");\n    const secret = await res.text();\n    const newProfile = { ...profile, secret };\n    setProfile(newProfile);\n  };\n  const logout = async () => {\n    const res = await fetch(\"/api/auth/logout\");\n    if (res.status === 200) {\n      Cookies.remove(\"id_token\");\n      setAuth(false);\n      setProfile(null);\n    }\n  };\n  return (\n    <>\n      <Head>\n        <title>Tweet Review</title>\n        <link\n          rel=\"stylesheet\"\n          href=\"https://css.zeit.sh/v1.css\"\n          type=\"text/css\"\n        />\n      </Head>\n      <main>\n        <h1>Tweet Review</h1>\n        <div className=\"buttons\">\n          <button onClick={getSecret}>Tell Me a Secret!</button>\n          {!isAuth ? (\n            <Link href={\"/api/auth/login\"}>\n              <a>\n                <button>Login</button>\n              </a>\n            </Link>\n          ) : (\n            <button onClick={logout}>Logout</button>\n          )}\n        </div>\n        {profile && profile.secret && <p>{profile.secret}</p>}\n      </main>\n      <style jsx>{`\n        .buttons {\n          display: flex;\n          justify-content: space-between;\n        }\n      `}</style>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}