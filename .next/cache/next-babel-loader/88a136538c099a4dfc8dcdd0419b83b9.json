{"ast":null,"code":"const cookie = require(\"cookie\");\n\nconst uuidv4 = require(\"uuid/v4\");\n\nconst cookieOptions = require(\"../../_util/cookie/options\");\n\nmodule.exports = async (req, res) => {\n  // generate random opaque value for state and nonce\n  const state = uuidv4();\n  const nonce = uuidv4(); // add state and nonce as httpOnly cookie for callback to check\n\n  res.setHeader(\"Set-Cookie\", [cookie.serialize(\"state\", String(state), cookieOptions(true, false)), cookie.serialize(\"nonce\", String(nonce), cookieOptions(true, false))]); // write redirect\n\n  res.writeHead(302, {\n    Location: `https://${process.env.AUTH0_DOMAIN}/authorize?response_type=code&audience=${process.env.AUTH0_AUDIENCE}&client_id=${process.env.AUTH0_CLIENT_ID}&redirect_uri=${process.env.AUTH0_REDIRECT_URI}/api/auth/callback&scope=openid%20profile%20email&state=${state}&nonce=${nonce}`\n  }); // send response\n\n  res.end();\n};","map":{"version":3,"sources":["/Users/mcs/Development/projects/sandbox/tweet-review/pages/api/auth/login/index.js"],"names":["cookie","require","uuidv4","cookieOptions","module","exports","req","res","state","nonce","setHeader","serialize","String","writeHead","Location","process","env","AUTH0_DOMAIN","AUTH0_AUDIENCE","AUTH0_CLIENT_ID","AUTH0_REDIRECT_URI","end"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,SAAD,CAAtB;;AACA,MAAME,aAAa,GAAGF,OAAO,CAAC,4BAAD,CAA7B;;AAEAG,MAAM,CAACC,OAAP,GAAiB,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACnC;AACA,QAAMC,KAAK,GAAGN,MAAM,EAApB;AACA,QAAMO,KAAK,GAAGP,MAAM,EAApB,CAHmC,CAInC;;AACAK,EAAAA,GAAG,CAACG,SAAJ,CAAc,YAAd,EAA4B,CAC1BV,MAAM,CAACW,SAAP,CAAiB,OAAjB,EAA0BC,MAAM,CAACJ,KAAD,CAAhC,EAAyCL,aAAa,CAAC,IAAD,EAAO,KAAP,CAAtD,CAD0B,EAE1BH,MAAM,CAACW,SAAP,CAAiB,OAAjB,EAA0BC,MAAM,CAACH,KAAD,CAAhC,EAAyCN,aAAa,CAAC,IAAD,EAAO,KAAP,CAAtD,CAF0B,CAA5B,EALmC,CASnC;;AACAI,EAAAA,GAAG,CAACM,SAAJ,CAAc,GAAd,EAAmB;AACjBC,IAAAA,QAAQ,EAAG,WAAUC,OAAO,CAACC,GAAR,CAAYC,YAAa,0CAAyCF,OAAO,CAACC,GAAR,CAAYE,cAAe,cAAaH,OAAO,CAACC,GAAR,CAAYG,eAAgB,iBAAgBJ,OAAO,CAACC,GAAR,CAAYI,kBAAmB,2DAA0DZ,KAAM,UAASC,KAAM;AADxQ,GAAnB,EAVmC,CAanC;;AACAF,EAAAA,GAAG,CAACc,GAAJ;AACD,CAfD","sourcesContent":["const cookie = require(\"cookie\");\nconst uuidv4 = require(\"uuid/v4\");\nconst cookieOptions = require(\"../../_util/cookie/options\");\n\nmodule.exports = async (req, res) => {\n  // generate random opaque value for state and nonce\n  const state = uuidv4();\n  const nonce = uuidv4();\n  // add state and nonce as httpOnly cookie for callback to check\n  res.setHeader(\"Set-Cookie\", [\n    cookie.serialize(\"state\", String(state), cookieOptions(true, false)),\n    cookie.serialize(\"nonce\", String(nonce), cookieOptions(true, false))\n  ]);\n  // write redirect\n  res.writeHead(302, {\n    Location: `https://${process.env.AUTH0_DOMAIN}/authorize?response_type=code&audience=${process.env.AUTH0_AUDIENCE}&client_id=${process.env.AUTH0_CLIENT_ID}&redirect_uri=${process.env.AUTH0_REDIRECT_URI}/api/auth/callback&scope=openid%20profile%20email&state=${state}&nonce=${nonce}`\n  });\n  // send response\n  res.end();\n};\n"]},"metadata":{},"sourceType":"script"}