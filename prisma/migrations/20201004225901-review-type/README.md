# Migration `20201004225901-review-type`

This migration has been generated by mcsdevv at 10/4/2020, 11:59:01 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."teams" DROP COLUMN "reviews_required",
ADD COLUMN "reviews_required" integer   NOT NULL DEFAULT 0

CREATE INDEX "teams.handle_index" ON "public"."teams"("handle")

ALTER INDEX "public"."metadata_twuid_unique" RENAME TO "metadata.twuid_unique"

ALTER INDEX "public"."teams_handle" RENAME TO "teams.handle_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201004220558-model-renaming..20201004225901-review-type
--- datamodel.dml
+++ datamodel.dml
@@ -3,88 +3,82 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
-model Team {
-  tuid            String       @id @default("")
-  name            String       @default("")
+model teams {
+  tuid            String    @id @default("")
+  name            String    @default("")
   protected       Boolean
-  handle          String       @default("")
-  avatar          String       @default("")
-  reviewsRequired String       @default("") @map("reviews_required")
-  plan            String       @default("")
-  tokenSecret     String       @default("") @map("token_secret")
-  tokenKey        String       @default("") @map("token_key")
-  inviteCode      String       @default("") @map("invite_code")
-  updatedAt       DateTime     @default(now()) @map("updated_at")
-  createdAt       DateTime     @default(now()) @map("created_at")
-  createdBy       String       @map("created_by")
-  members         Membership[]
-  tweets          Tweet[]
+  handle          String    @unique @default("")
+  avatar          String    @default("")
+  reviewsRequired Int       @default(0) @map("reviews_required")
+  plan            String    @default("")
+  tokenSecret     String    @default("") @map("token_secret")
+  tokenKey        String    @default("") @map("token_key")
+  inviteCode      String    @default("") @map("invite_code")
+  updatedAt       DateTime  @default(now()) @map("updated_at")
+  createdAt       DateTime  @default(now()) @map("created_at")
+  createdBy       String    @map("created_by")
+  members         members[]
+  tweets          tweets[]
-  @@map("teams")
+  @@index([handle])
 }
-model Membership {
+model members {
   uid  String @default("")
   tuid String @default("")
   role String @default("member")
-  team Team   @relation(fields: [tuid], references: [tuid])
-  user User   @relation(fields: [uid], references: [uid])
+  team teams  @relation(fields: [tuid], references: [tuid])
+  user users  @relation(fields: [uid], references: [uid])
   @@id([uid, tuid])
-  @@map("members")
 }
-model Tweet {
-  twuid            String     @id @default("")
-  tuid             String     @default("")
+model tweets {
+  twuid            String      @id @default("")
+  tuid             String      @default("")
   title            String
   type             String
   text             String
-  createdAt        DateTime   @default(now()) @map("created_at")
-  createdBy        String     @map("created_by")
-  updatedAt        DateTime   @default(now()) @map("updated_at")
+  createdAt        DateTime    @default(now()) @map("created_at")
+  createdBy        String      @map("created_by")
+  updatedAt        DateTime    @default(now()) @map("updated_at")
+  metricsUpdatedAt DateTime    @default(now()) @map("metrics_updated_at")
+  tweetId          String      @map("tweet_id")
   retweets         Int
   replies          Int
   favorites        Int
-  metricsUpdatedAt DateTime   @default(now()) @map("metrics_updated_at")
-  tweetId          String     @map("tweet_id")
-  team             Team       @relation(fields: [tuid], references: [tuid])
-  approvals        Approval[]
-  comments         Comment[]
-  metadata         Metadata
-
-  @@map("tweets")
+  team             teams       @relation(fields: [tuid], references: [tuid])
+  approvals        approvals[]
+  comments         comments[]
+  metadata         metadata?
 }
-model Approval {
+model approvals {
   tauid String
   twuid String
   uid   String
-  tweet Tweet  @relation(fields: [twuid], references: [twuid])
+  tweet tweets @relation(fields: [twuid], references: [twuid])
   @@id([tauid, twuid])
-  @@map("approvals")
 }
-model Comment {
+model comments {
   tcuid   String   @id
   twuid   String
   addedAt DateTime @default(now()) @map("added_at")
   addedBy String   @map("added_by")
   comment String
-  tweets  Tweet    @relation(fields: [twuid], references: [twuid])
-
-  @@map("comments")
+  tweets  tweets   @relation(fields: [twuid], references: [twuid])
 }
-model Metadata {
+model metadata {
   twmuid                      String   @id @default("")
-  twuid                       String?
+  twuid                       String?  @unique
   og_url                      String?
   og_type                     String?
   og_title                    String?
   og_img                      String?
@@ -117,20 +111,16 @@
   twitter_title               String?
   cardType                    String?
   fallbackImg                 Boolean?
   url                         String?
-  tweet                       Tweet?   @relation(fields: [twuid], references: [twuid])
-
-  @@map("metadata")
+  tweet                       tweets?  @relation(fields: [twuid], references: [twuid])
 }
-model User {
-  uid       String       @id @default("")
-  email     String       @unique @default("")
-  name      String       @default("")
-  picture   String       @default("")
-  createdAt DateTime     @default(now()) @map("created_at")
-  updatedAt DateTime     @default(now()) @map("updated_at")
-  members   Membership[]
-
-  @@map("users")
+model users {
+  uid       String    @id @default("")
+  email     String    @unique @default("")
+  name      String    @default("")
+  picture   String    @default("")
+  createdAt DateTime  @default(now()) @map("created_at")
+  updatedAt DateTime  @default(now()) @map("updated_at")
+  members   members[]
 }
```


