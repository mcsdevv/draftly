# Migration `20201004220558-model-renaming`

This migration has been generated by mcsdevv at 10/4/2020, 11:05:58 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."teams_members" DROP CONSTRAINT "teams_members_tuid_fkey"

ALTER TABLE "public"."teams_members" DROP CONSTRAINT "teams_members_uid_fkey"

ALTER TABLE "public"."tweets_approvals" DROP CONSTRAINT "tweets_approvals_twuid_fkey"

ALTER TABLE "public"."tweets_comments" DROP CONSTRAINT "tweets_comments_twuid_fkey"

ALTER TABLE "public"."tweets_meta" DROP CONSTRAINT "tweets_meta_twuid_fkey"

ALTER TABLE "public"."tweets" ALTER COLUMN "tuid" SET DEFAULT E'',
DROP COLUMN "retweets",
ADD COLUMN "retweets" integer   NOT NULL ,
DROP COLUMN "replies",
ADD COLUMN "replies" integer   NOT NULL ,
DROP COLUMN "favorites",
ADD COLUMN "favorites" integer   NOT NULL 

CREATE TABLE "public"."members" (
"uid" text   NOT NULL DEFAULT E'',
"tuid" text   NOT NULL DEFAULT E'',
"role" text   NOT NULL DEFAULT E'member',
PRIMARY KEY ("uid","tuid")
)

CREATE TABLE "public"."approvals" (
"tauid" text   NOT NULL ,
"twuid" text   NOT NULL ,
"uid" text   NOT NULL ,
PRIMARY KEY ("tauid","twuid")
)

CREATE TABLE "public"."comments" (
"tcuid" text   NOT NULL ,
"twuid" text   NOT NULL ,
"added_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"added_by" text   NOT NULL ,
"comment" text   NOT NULL ,
PRIMARY KEY ("tcuid")
)

CREATE TABLE "public"."metadata" (
"twmuid" text   NOT NULL DEFAULT E'',
"twuid" text   ,
"og_url" text   ,
"og_type" text   ,
"og_title" text   ,
"og_img" text   ,
"og_description" text   ,
"canonical" text   ,
"twitter_site_title" text   ,
"twitter_site_id" text   ,
"twitter_site" text   ,
"twitter_player_width" text   ,
"twitter_player_stream" text   ,
"twitter_player_height" text   ,
"twitter_player" text   ,
"twitter_img_src" text   ,
"twitter_img_alt" text   ,
"twitter_img" text   ,
"twitter_domain" text   ,
"twitter_description" text   ,
"twitter_creator_id" text   ,
"twitter_creator" text   ,
"twitter_card" text   ,
"twitter_app_url_ipad" text   ,
"twitter_app_id_ipad" text   ,
"twitter_app_name_ipad" text   ,
"twitter_app_url_iphone" text   ,
"twitter_app_id_iphone" text   ,
"twitter_app_name_iphone" text   ,
"twitter_app_url_googleplay" text   ,
"twitter_app_id_googleplay" text   ,
"twitter_app_name_googleplay" text   ,
"twitter_title" text   ,
"cardType" text   ,
"fallbackImg" boolean   ,
"url" text   ,
PRIMARY KEY ("twmuid")
)

CREATE UNIQUE INDEX "metadata_twuid_unique" ON "public"."metadata"("twuid")

ALTER TABLE "public"."members" ADD FOREIGN KEY ("tuid")REFERENCES "public"."teams"("tuid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."members" ADD FOREIGN KEY ("uid")REFERENCES "public"."users"("uid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."approvals" ADD FOREIGN KEY ("twuid")REFERENCES "public"."tweets"("twuid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."comments" ADD FOREIGN KEY ("twuid")REFERENCES "public"."tweets"("twuid") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."metadata" ADD FOREIGN KEY ("twuid")REFERENCES "public"."tweets"("twuid") ON DELETE SET NULL ON UPDATE CASCADE

DROP TABLE "public"."teams_members"

DROP TABLE "public"."tweets_approvals"

DROP TABLE "public"."tweets_comments"

DROP TABLE "public"."tweets_meta"

ALTER INDEX "public"."users_ekey" RENAME TO "users.email_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201004220558-model-renaming
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,136 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model Team {
+  tuid            String       @id @default("")
+  name            String       @default("")
+  protected       Boolean
+  handle          String       @default("")
+  avatar          String       @default("")
+  reviewsRequired String       @default("") @map("reviews_required")
+  plan            String       @default("")
+  tokenSecret     String       @default("") @map("token_secret")
+  tokenKey        String       @default("") @map("token_key")
+  inviteCode      String       @default("") @map("invite_code")
+  updatedAt       DateTime     @default(now()) @map("updated_at")
+  createdAt       DateTime     @default(now()) @map("created_at")
+  createdBy       String       @map("created_by")
+  members         Membership[]
+  tweets          Tweet[]
+
+  @@map("teams")
+}
+
+model Membership {
+  uid  String @default("")
+  tuid String @default("")
+  role String @default("member")
+  team Team   @relation(fields: [tuid], references: [tuid])
+  user User   @relation(fields: [uid], references: [uid])
+
+  @@id([uid, tuid])
+  @@map("members")
+}
+
+model Tweet {
+  twuid            String     @id @default("")
+  tuid             String     @default("")
+  title            String
+  type             String
+  text             String
+  createdAt        DateTime   @default(now()) @map("created_at")
+  createdBy        String     @map("created_by")
+  updatedAt        DateTime   @default(now()) @map("updated_at")
+  retweets         Int
+  replies          Int
+  favorites        Int
+  metricsUpdatedAt DateTime   @default(now()) @map("metrics_updated_at")
+  tweetId          String     @map("tweet_id")
+  team             Team       @relation(fields: [tuid], references: [tuid])
+  approvals        Approval[]
+  comments         Comment[]
+  metadata         Metadata
+
+  @@map("tweets")
+}
+
+model Approval {
+  tauid String
+  twuid String
+  uid   String
+  tweet Tweet  @relation(fields: [twuid], references: [twuid])
+
+  @@id([tauid, twuid])
+  @@map("approvals")
+}
+
+model Comment {
+  tcuid   String   @id
+  twuid   String
+  addedAt DateTime @default(now()) @map("added_at")
+  addedBy String   @map("added_by")
+  comment String
+  tweets  Tweet    @relation(fields: [twuid], references: [twuid])
+
+  @@map("comments")
+}
+
+model Metadata {
+  twmuid                      String   @id @default("")
+  twuid                       String?
+  og_url                      String?
+  og_type                     String?
+  og_title                    String?
+  og_img                      String?
+  og_description              String?
+  canonical                   String?
+  twitter_site_title          String?
+  twitter_site_id             String?
+  twitter_site                String?
+  twitter_player_width        String?
+  twitter_player_stream       String?
+  twitter_player_height       String?
+  twitter_player              String?
+  twitter_img_src             String?
+  twitter_img_alt             String?
+  twitter_img                 String?
+  twitter_domain              String?
+  twitter_description         String?
+  twitter_creator_id          String?
+  twitter_creator             String?
+  twitter_card                String?
+  twitter_app_url_ipad        String?
+  twitter_app_id_ipad         String?
+  twitter_app_name_ipad       String?
+  twitter_app_url_iphone      String?
+  twitter_app_id_iphone       String?
+  twitter_app_name_iphone     String?
+  twitter_app_url_googleplay  String?
+  twitter_app_id_googleplay   String?
+  twitter_app_name_googleplay String?
+  twitter_title               String?
+  cardType                    String?
+  fallbackImg                 Boolean?
+  url                         String?
+  tweet                       Tweet?   @relation(fields: [twuid], references: [twuid])
+
+  @@map("metadata")
+}
+
+model User {
+  uid       String       @id @default("")
+  email     String       @unique @default("")
+  name      String       @default("")
+  picture   String       @default("")
+  createdAt DateTime     @default(now()) @map("created_at")
+  updatedAt DateTime     @default(now()) @map("updated_at")
+  members   Membership[]
+
+  @@map("users")
+}
```


